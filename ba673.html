<!DOCTYPE html>
<html><head><title>결의서등록 - 청구(일반)</title>
<meta http-equiv="content-type" content="text/html;charset=euc-kr">
<meta name="description" content="">
<link rel="stylesheet" href="../g5-manual/lib/g5/gauce5.css">
<script src="../g5-manual/lib/g5/gauce5.js"></script>
<script src="/js/showModalDialog.js"></script>
<link rel="stylesheet" href="/css/common_5.css">
<link rel="stylesheet" href="/assets/css/common.css">
<link rel="stylesheet" href="/assets/css/style.css">
<script language="javascript" src="/js/common_5.js"></script>
<script language="javascript" src="/js/job_5.js"></script>
<script language="JavaScript">
	var detlDsCls = "";			//상세내역 dataSet 구분
	var geomtoCnt = Number(getSettingDataCo("1","1000","KYEOL_GEOMTO_STEP_CNT"));
	/**************************************************************************
		▶ 버튼
	***************************************************************************/
	function init(){
		btnControlCo(searchOn, cancelOn, saveOn, insertOn, deleteOn, excelOn, printOn);	
 		menuBarInfoView();
		getJeungbingKndCo(); 			//증빙종류
		getDataSetHeaders();			//DataSet 헤더 만들기
 		radio_sawon_buseo_cls.CodeValue = "1";
		insert();
 		setSetting();
 		if(commonWpId==1065) grd_detl.ColumnProp("bigo2", "Show").val = "true";
 		if(commonWpId==113||commonWpId==1075||commonWpId==1065) file_control.FileFilterString = "1";
	}

	// 취소
	function cancel(){
//showDataSetCo(DataSetBaSetting,"DataSetBaSetting");
//showDataSetCo(DataSetBaKyeoluiseo,"DataSetBaKyeoluiseo");
//showDataSetCo(DataSetBaKyeoluiseoDetl,"DataSetBaKyeoluiseoDetl");
        DataSetBaKyeoluiseo.Undo(DataSetBaKyeoluiseo.RowPosition);
        DataSetBaKyeoluiseoDetl.Undo(DataSetBaKyeoluiseoDetl.RowPosition);
	}

	//삽입
	function insert() {
		DataSetBaKyeoluiseo.ClearData();
		DataSetBaKyeoluiseoDetl.ClearData();
		removeCtrlData();
        DataSetBaKyeoluiseo.AddRow();
        setInitControlCo(1);        		//초기값 셋팅(파라미터 값은 초기 focus 순서)
	    pilsuColorChangeCo();
		if(isNullCo(txt_u_jakseongja_cd.value)){
			txt_u_jakseongja_cd.value = DataSetBaCommon.NameValue(1,"u_sawon_cd").val;
			txt_jakseongja_nm.value = DataSetBaCommon.NameValue(1,"sawon_nm").val;
		}	
		em_baluiil.Text = commonToday;
		luxe_kyeoljae_cls.Index = 0;
        makeUpmuNo();
		insertDetl();
		setDefaultBuseoCo();
		setKyeoljaeja();
		btn_jongjeon_kyeol_popup.disabled = false;
	}

	//행추가 - 수주내역 행만 추가
	function insertDetl(){
		if(DataSetBaKyeoluiseo.CountRow==0){
			alert("  결의서 마스터정보가 없습니다.  ");
			return;
		}
        if(checkNotNullGridAndFocusCo(DataSetBaKyeoluiseoDetl,grd_detl)){
            DataSetBaKyeoluiseoDetl.AddRow();
            DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"seungin_cls").val = "1";
            DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_jeungbing_cd").val = "0";
        }
    }    

	// 저장
	function save(){
		if(DataSetBaKyeoluiseo.CountRow==0){
			alert(" 결의서 마스터정보가 없습니다.  \n\n  추가하거나 검색하세요! ");
			return;
		}
		if(DataSetBaKyeoluiseoDetl.CountRow==0){
			alert(" 결의서 상세정보가 하나도 없습니다.  \n\n 결의서에는 하나 이상의 상세정보가 필요합니다! ");
			return;
		}
		var kCls = DataSetBaKyeoluiseo.OrgNameValue(1,"kyeoljae_cls");
		if(kCls!="0"){
			alert(" 결재된 결의서는 수정할 수 없습니다. \n\n 확인하시기 바랍니다. ");
			return;
		}
		var acCls = "";
        for(var i=1;i<=DataSetBaKyeoluiseoDetl.CountRow; i++){
        	acCls = DataSetBaKyeoluiseoDetl.NameValue(i,"acct_cheori_cls").val;
        	if((acCls=="1")&&(DataSetBaKyeoluiseoDetl.SysStatus(i)==3)){ 
        		alert(i+" 번째행 데이터는 회계처리되어 있어 수정할 수 없습니다. \n\n 확인하시기 바랍니다. ");
        		DataSetBaKyeoluiseoDetl.RowPostion = i;
        		return;
        	}
    	}
        if(checkNotNullAndFocusCo(DataSetBaKyeoluiseo)){
			if(isNullCo(em_cheongguil.Text)){
				alert(" 청구일을 입력하세요. ");
				return;
			}	
			var beforeDay = addDateCo(em_baluiil.Text,-90);
			var afterDay  = addDateCo(em_baluiil.Text,90);
			if((em_cheongguil.Text<=beforeDay)||(em_cheongguil.Text>afterDay)){
				if(confirm(" 발의일과 청구일이 90일 이상 차이납니다. \n\n 그래도 저장하시겠습니까? ")==false){
					em_cheongguil.Focus();
					return;
				}				
			}
			if(checkNotNullGridAndFocusCo(DataSetBaKyeoluiseoDetl,grd_detl)){
				//결의서구분: 청구(일반)(201), 청구일, 회계처리구분: 미처리(0) setting
				DataSetBaKyeoluiseo.NameValue(1,"kyeoluiseo_cls").val = "201";
		        for(var i=1;i<=DataSetBaKyeoluiseoDetl.CountRow; i++){
		        	DataSetBaKyeoluiseoDetl.NameValue(i,"jichul_s_il").val = em_cheongguil.Text;
		        	if(isNullCo(DataSetBaKyeoluiseoDetl.NameValue(i,"acct_cheori_cls").val)) DataSetBaKyeoluiseoDetl.NameValue(i,"acct_cheori_cls").val = "0";
		        	DataSetBaKyeoluiseoDetl.NameValue(i,"u_mgt_item_cd").val = txt_u_mgt_item_cd.value;
					DataSetBaKyeoluiseoDetl.NameValue(i,"u_proj_cd").val = txt_u_proj_cd.value;
					DataSetBaKyeoluiseoDetl.NameValue(i,"sawon_buseo_cls").val = radio_sawon_buseo_cls.CodeValue;
					DataSetBaKyeoluiseoDetl.NameValue(i,"u_sawon_buseo_cd").val = txt_u_sawon_buseo_cd.value;
		        }
				var params = "jobId=JobBaKyeoluiseo,kyeolSeqStr="+DataSetBaKyeoluiseo.NameValue(DataSetBaKyeoluiseo.RowPosition,"kyeoluiseo_seq").val;
				params = params + ",kyeoluiseoCls=201";
				params = params + ",totAmt="+DataSetBaKyeoluiseoDetl.NameSum("amt",0,0);
				params = params + ",uGeomtojaCd="+DataSetBaKyeoluiseo.NameValue(1,"u_geomtoja_cd").val;
				params = params + ",uGeomtoja2Cd="+DataSetBaKyeoluiseo.NameValue(1,"u_geomtoja2_cd").val;
				params = params + ",uSeunginjaCd="+DataSetBaKyeoluiseo.NameValue(1,"u_seunginja_cd").val;
				params = params + ",baluiil="+DataSetBaKyeoluiseo.NameValue(1,"baluiil").val;
		    	params = params + ",gauceCls=gauce5";
				//alert(params);
	        	tr_all_u.Parameters = params;
	        	tr_all_u.Post();
	        }	
		}
	}

	// 조회
	function search() {	
		getKyeoluiseo();
	}

    //삭제 : 결의서정보와 결의서상세내역 전부를 삭제
    function remove() {
        if (DataSetBaKyeoluiseo.CountRow==0) return;
		var kCls = DataSetBaKyeoluiseo.OrgNameValue(1,"kyeoljae_cls");
		if(kCls!="0"){
			alert(" 결재된 결의서는 삭제할 수 없습니다. \n\n 확인하시기 바랍니다. ");
			return;
		}
		var acCls = "";
        for(var i=1;i<=DataSetBaKyeoluiseoDetl.CountRow; i++){
        	acCls = DataSetBaKyeoluiseoDetl.NameValue(i,"acct_cheori_cls").val;
        	if(acCls=="1"){ 
        		alert("회계처리된 데이터가 있어 삭제할 수 없습니다. \n\n 확인하시기 바랍니다. ");
        		return;
        	}
    	}
        var kyeoluiseoSeq = DataSetBaKyeoluiseo.NameValue(DataSetBaKyeoluiseo.RowPosition,"kyeoluiseo_seq").val;
        if(DataSetBaKyeoluiseo.SysStatus(DataSetBaKyeoluiseo.RowPosition)!=1){
            if (confirm("결의서정보를 삭제하시겠습니까?")==false) return;
            else{
                DataSetBaKyeoluiseo.DeleteRow(DataSetBaKyeoluiseo.RowPosition);
	        	tr_main_u.Parameters = "jobId=JobBaKyeoluiseo,kyeolSeqStr="+kyeoluiseoSeq;
	        	tr_main_u.Post();
            }
        }else{
            alert("저장된 결의서정보만 삭제가 가능합니다.");
            return;
        }
    }

    //행삭제 - 상세내역만 삭제
    function removeDetl(){
        if (DataSetBaKyeoluiseoDetl.CountRow==0) return;
		var kCls = DataSetBaKyeoluiseo.OrgNameValue(1,"kyeoljae_cls");
		if(kCls!="0"){
			alert(" 결재된 결의서는 삭제할 수 없습니다. \n\n 확인하시기 바랍니다. ");
			return;
		}
		var acCls = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"acct_cheori_cls").val;
        if(acCls=="1"){ 
    		alert("회계처리된 데이터는 삭제할 수 없습니다. \n\n 확인하시기 바랍니다. ");
    		return;
    	}
		if(DataSetBaKyeoluiseoDetl.CountRow==1){
			alert(" 삭제시 결의서 상세정보가 모두 없어집니다. \n\n 결의서에는 하나 이상의 상세정보가 필요합니다! ");
			return;
		}
		if(DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"seungin_cls").val!="1"){
			errorMsgToTitleBarCo("승인구분이 미결인 경우만 삭제할 수 있습니다!");
			return;
		}	
        if(DataSetBaKyeoluiseoDetl.SysStatus(DataSetBaKyeoluiseoDetl.RowPosition)==1){
            DataSetBaKyeoluiseoDetl.DeleteRow(DataSetBaKyeoluiseoDetl.RowPosition);
        }else if(confirm('선택한 결의서 상세내역 데이터를 삭제하시겠습니까?')){
            DataSetBaKyeoluiseoDetl.DeleteRow(DataSetBaKyeoluiseoDetl.RowPosition);
	        tr_detl_u.Parameters = "jobId=JobBaKyeoluiseo";
	        tr_detl_u.Post();
        }else  return;
	}	

	// excel
	function excel() {
       	grd_detl.GridToExcel('결의서명세','결의서명세',2);
	}

	// print
	function print(){
	}


	/***************************************************************************
		▶ 조회
	***************************************************************************/

    function getDataSetHeaders(){
        tr_all_r.Parameters = "jobId=JobBaKyeoluiseo,johoeCls=dataSetHeader";
        tr_all_r.Post();
	}

    // 결의서 data 조회
    function getKyeoluiseo(){
    	detlDsCls = "search";
    	var kyeoluiseoNo = txt_kyeoluiseo_no.value
    	DataSetBaKyeoluiseo.ClearData();
        DataSetBaKyeoluiseoDetl.ClearData();
        removeCtrlData();
		if(isNullCo(kyeoluiseoNo)){
			 txt_kyeoluiseo_no.focus();
			 return;
		}	 
        tr_kyeoluiseo_r.Parameters = "jobId=JobBaKyeoluiseo,johoeCls=kyeoluiseo,kyeoluiseoNo="+kyeoluiseoNo;
        tr_kyeoluiseo_r.Post();
        //em_baluiil.Text = DataSetBaKyeoluiseo.NameValue(DataSetBaKyeoluiseo.RowPosition, "yyyymmdd").val;
   		btn_jongjeon_kyeol_popup.disabled = true;
    }

    // 결의서내역 data 조회
    function getKyeoluiseoDetl(kyeolSeq){
    	if(isNullCo(kyeolSeq)) kyeolSeq = DataSetBaKyeoluiseo.NameValue(DataSetBaKyeoluiseo.RowPosition,"kyeoluiseo_seq").val;
        tr_detl_r.Parameters = "jobId=JobBaKyeoluiseo,johoeCls=kyeoluiseoDetl,kyeoluiseoSeq="+kyeolSeq;
        tr_detl_r.Post();
    }

	//결의서 결재설정정보 가져오기    
	function getKyeoljaeSettingInfo(){
		var params = "jobId=JobBaSetting,johoeCls=kyeoljaeSettingInfo,userId=1,settingId=KYEOLJAE_CHEONGGU_ILBAN_KYEOL";
	    tr_setting_r.Parameters = params;
	    tr_setting_r.Post();
	}

	/***************************************************************************
		▶ 기타
	***************************************************************************/
	//업무순번 만들기
	function makeUpmuNo(){
		DataSetBaShortStr.ClearData();
        tr_kyeoluiseo_no_r.Parameters = "jobId=JobBaSelect2,daoId=makeUpmuNo:upmu=결의서:theDay="+em_baluiil.Text+":seqCnt=3";
        tr_kyeoluiseo_no_r.Post();
        DataSetBaKyeoluiseo.NameValue(DataSetBaKyeoluiseo.RowPosition,"kyeoluiseo_no").val= DataSetBaShortStr.NameValue(1,"str").val;
	}

    // 합계
    function setSumText(){
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"amt_sum").val = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"amt").val+DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"bugase").val;
    }

	//부가세 관련 추가정보 지우기
	function removeChugaInfo(){
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_jijeom_cd").val = "";
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"saeopja_no").val = "";
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_card_cd").val = "";
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"card_nm").val = "";
        DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"seungin_no").val = "";
	}

	//지점 갯수 가져오기
	function getJijeomCnt() {
		tr_jijeom_cnt_r.Parameters = "jobId=JobBaJijeom, johoeCls=jijeomCnt";
		tr_jijeom_cnt_r.Post();
		return DataSetBaNum.NameValue(1,"num").val;
	}

	//컨트롤에 있는 데이터 지우기
	function removeCtrlData(){
		em_cheongguil.Text = "";
		txt_u_mgt_item_cd.value = "";
		txt_mgt_item_nm.value = "";
		txt_u_proj_cd.value = "";
		txt_proj_nm.value = "";
		radio_sawon_buseo_cls.CodeValue="1";
		txt_u_sawon_buseo_cd.value = "";
		txt_sawon_buseo_nm.value = "";
	}	

	//사원부서 default 값 -- 작성자
	function setDefaultSawonOrBuseo(){
		if(isNullCo(txt_u_sawon_buseo_cd.value)){
			txt_u_sawon_buseo_cd.value =  txt_u_jakseongja_cd.value;
			txt_sawon_buseo_nm.value = txt_jakseongja_nm.value;
	 		radio_sawon_buseo_cls.CodeValue = "1";
	 	}	
	}

	function setSetting(){
 		if(getSettingDataCo("1","7000","KYEOL_CHEOMBU_FILE_FUNC")=="T") grd_detl.ColumnProp("url_str", "Show").val = true;	//사업장 설정data 가져오기(userId, knd, settingId,wpId)
 		//var cnt = getSettingDataCo("1","1000","KYEOL_GEOMTO_STEP_CNT");

 		if(geomtoCnt==1){
 			td_geomtoja2_1.style.display = "none";
 			td_geomtoja2_2.style.display = "none";
 		}else if(geomtoCnt>1){
 			td_geomtoja2_1.style.display = "inline";
 			td_geomtoja2_2.style.display = "inline";
 		}
	}

	function setKyeoljaeja(){
 		getKyeoljaeSettingInfo();
		if(DataSetBaSetting.CountRow>0){
			if(isNotNullCo(DataSetBaSetting.NameValue(1,"value_01").val)){
	 			txt_u_geomtoja_cd.value = DataSetBaSetting.NameValue(1,"value_01").val;
	 			txt_geomtoja_nm.value = DataSetBaSetting.NameValue(1,"value_01_bigo").val;
	 			btn_geomtoja.disabled = true;
				txt_u_geomtoja_cd.readOnly = true;
	 			txt_geomtoja_nm.readOnly = true;
	 	 	}
			if(isNotNullCo(DataSetBaSetting.NameValue(1,"value_05").val)){
	 			txt_u_seunginja_cd.value = DataSetBaSetting.NameValue(1,"value_05").val;
	 			txt_seunginja_nm.value = DataSetBaSetting.NameValue(1,"value_05_bigo").val;
	 			btn_seunginja.disabled = true;
				txt_u_seunginja_cd.readOnly = true;
	 			txt_seunginja_nm.readOnly = true;
	 		}
 			if((geomtoCnt>1)&&isNotNullCo(DataSetBaSetting.NameValue(1,"value_03").val)){
	 			txt_u_geomtoja2_cd.value = DataSetBaSetting.NameValue(1,"value_03").val;
	 			txt_geomtoja2_nm.value = DataSetBaSetting.NameValue(1,"value_03_bigo").val;
	 			btn_geomtoja2.disabled = true;
				txt_u_geomtoja2_cd.readOnly = true;
	 			txt_geomtoja2_nm.readOnly = true;
	 		}
		}
	}

    // 종전결의서 조회후 상세내역 data Setting
    function setDataSetDetl(paraObj){
    	DataSetBaKyeoluiseoDetl.ClearData();
        for(var i=1;i<=paraObj.uClntCd.length; i++){
        	DataSetBaKyeoluiseoDetl.AddRow();
        	DataSetBaKyeoluiseoDetl.NameValue(i,"seungin_cls").val = "1";			//미결
        	DataSetBaKyeoluiseoDetl.NameValue(i,"acct_cheori_cls").val = "0";		//미처리
        	DataSetBaKyeoluiseoDetl.NameValue(i,"u_clnt_cd").val = paraObj.uClntCd[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"clnt_nm").val = paraObj.clntNm[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"u_jeungbing_cd").val = paraObj.uJeungbingCd[i-1] ;
        	DataSetBaKyeoluiseoDetl.NameValue(i,"jeungbing_nm").val = paraObj.jeungbingNm[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"amt").val = paraObj.amt[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"bugase").val = paraObj.bugase[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"amt_sum").val = paraObj.amtSum[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"naeyeok_cd").val = paraObj.naeyeokCd[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"u_naeyeok_cd").val = paraObj.uNaeyeokCd[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"naeyeok").val = paraObj.naeyeok[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"m_cls").val = paraObj.mCls[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"m_knd").val = paraObj.mKnd[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"g_iss_cls").val = paraObj.gIssCls[i-1];
        	DataSetBaKyeoluiseoDetl.NameValue(i,"bigo").val = paraObj.bigo[i-1];
    	}
	}

	/***************************************************************************
		▶ 팝업
	***************************************************************************/
	var gGubun;
    function winPopup(gubun) {
        var winObj;
        var popupParam;
		gGubun = gubun;
        switch(gubun) {
            case 1:  //결의서번호 리스트 
				popupParam = new Popup3ParamCo("201",txt_u_jakseongja_cd.value,txt_jakseongja_nm.value);
                winObj = getKyeoluiseoPopupCo(popupParam);
                break;
            case 2:  //작성자
                winObj = sawonPopupCo(null);
                break;
            case 4:  //검토자
           		popupParam = new Popup3ParamCo("sawonList","all","");
                winObj = sawonPopupCo(popupParam);
                break;
            case 5:  //승인자
           		popupParam = new Popup3ParamCo("sawonList","all","");
                winObj = sawonPopupCo(popupParam);
                break;
            case 6: //관리항목	
				popupParam = new PopupParamCo("");
				winObj     = mgtItemPopupCo(popupParam);
            	break;
            case 7:  //프로젝트
                winObj = projPopupCo(null);
                break;  
            case 8:  //사원부서
                if(radio_sawon_buseo_cls.CodeValue=="1")  		winObj = sawonPopupCo(null);
                else if(radio_sawon_buseo_cls.CodeValue=="2")	winObj = buseoPopupCo(null);
                break;
            case 9: //거래처
                winObj = winPopupCo("10","0","0");
                break;
			case 10: //내역등록 - 파라미터 : 결의서구분,사원코드,사원명
				popupParam = new Popup3ParamCo("201",txt_u_jakseongja_cd.value,txt_jakseongja_nm.value);
		        winObj = regNaeyeokPopupCo(popupParam);
				break;
			case 11: //계산서 추가정보
				var uClntCd = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_clnt_cd").val;
				var uJeungbingCd = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_jeungbing_cd").val;
				var uJijeomCd = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_jijeom_cd").val;
                var saeopjaNo = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"saeopja_no").val;
                var uCardCd = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_card_cd").val;
                var cardNm = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"card_nm").val;
                var seunginNo = DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"seungin_no").val;
                //alert(uJbCd+" "+uJijeomCd+" "+saeopjaNo+" "+uCardCd+" "+cardNm+" "+seunginNo+" ");
                //파라미터 : 매매구분(2:매입),거래처코드,증빙코드,지점수,지점코드,사업자번호,카드코드,카드명,승인번호
				popupParam = new popupParamsCo("2",uClntCd,uJeungbingCd,getJijeomCnt(),uJijeomCd,saeopjaNo,uCardCd,cardNm,seunginNo);
		        winObj = gyesanseoChugaPopupCo(popupParam);
				break;
            case 12:  //검토자2
           		popupParam = new Popup3ParamCo("sawonList","all","");
                winObj = sawonPopupCo(popupParam);
                break;
            case 13:  //종전결의서 팝업 
            	var paraObj = new Object();
            	paraObj.kyeoluiseoCls = "201";
            	paraObj.uJakseongjaCd = txt_u_jakseongja_cd.value;
            	paraObj.jakseongjaNm = txt_jakseongja_nm.value;
                winObj = jongjeonKyeoluiseoPopupCo(paraObj);  //
                break;
            default :
        }//

    }

	function showModalDialogCallback(winObj){
        if(typeof(winObj)=="object"){
            switch(gGubun) {
                case 1: //결의서번호 리스트
                    txt_kyeoluiseo_no.value = winObj.kyeoluiseo_no;
                    getKyeoluiseo();
                    break;
	            case 2: //작성자
                    txt_u_jakseongja_cd.value = winObj.code; 
                    txt_jakseongja_nm.value   = winObj.name; 
	                break;
	            case 4: //검토자
                    txt_u_geomtoja_cd.value = winObj.code; 
                    txt_geomtoja_nm.value   = winObj.name; 
	                break;
	            case 5: //승인자
                    txt_u_seunginja_cd.value = winObj.code; 
                    txt_seunginja_nm.value   = winObj.name; 
	                break;
	            case 6: //관리항목
					txt_u_mgt_item_cd.value = winObj.code;
					txt_mgt_item_nm.value   = winObj.name;
					txt_u_proj_cd.focus();
	            	break;
                case 7: //프로젝트
                    txt_u_proj_cd.value = winObj.code; 
                    txt_proj_nm.value   = winObj.name; 
                    txt_u_sawon_buseo_cd.focus();
                    break;  
                case 8: //사원부서
                    txt_u_sawon_buseo_cd.value = winObj.code; 
                    txt_sawon_buseo_nm.value   = winObj.name; 
                    break;  
                case 9: //거래처
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_clnt_cd").val = winObj.code;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"clnt_nm").val   = winObj.name;
                    grd_detl.SetColumn("u_jeungbing_cd");
                    break;
				case 10: //개인내역
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"naeyeok_cd").val = winObj.code;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_naeyeok_cd").val = winObj.uCode;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"naeyeok").val   = winObj.name;
                    grd_detl.SetColumn("bigo");
	                break;
				case 11: //계산서 추가정보
					//alert(winObj.saeopjaNo+" "+winObj.uCardCd+" "+winObj.cardNm+" "+winObj.seunginNo);
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_jijeom_cd").val = winObj.uJijeomCd;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"saeopja_no").val = winObj.saeopjaNo;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"u_card_cd").val = winObj.uCardCd;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"card_nm").val = winObj.cardNm;
                    DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"seungin_no").val = winObj.seunginNo;
	                break;
	            case 12: //검토자2
                    txt_u_geomtoja2_cd.value = winObj.code; 
                    txt_geomtoja2_nm.value   = winObj.name; 
	                break;
	            case 13: //종전결의서 조회 후 상세내역 data Setting
    				detlDsCls = "jongjeon";
	            	setDataSetDetl(winObj);
	                break;
                default :
            }//
        }
	}

	function calendarBaluiil(){
		var winObj = window.showModalDialog("/js/calendar.html", window, "dialogwidth:170px;dialogheight:193px;center:0;status:0;scroll:no;help:no;");
		if(typeof(winObj)=="object"){
			em_baluiil.Text = winObj.yyyymmdd;
			makeUpmuNo();
		}
	}

	function calendarCheongguil(){
		var winObj = window.showModalDialog("/js/calendar.html", window, "dialogwidth:170px;dialogheight:193px;center:0;status:0;scroll:no;help:no;");
		if(typeof(winObj)=="object") em_cheongguil.Text = winObj.yyyymmdd;
	}

	/**************************************************************************
		▶ DataSet, Transaction Object 생성
	***************************************************************************/	

</script>

<!--결의서 상세내역 조회-->

<g5-tr id="tr_detl_r" >
    <param name="KeyName"    value="toinb_dataid4">
    <param name="KeyValue"   value="JSP(O:DataSetBaKyeoluiseoDetl=DataSetBaKyeoluiseoDetl)">
    <param name="Action"     value="/servlet/GateServlet">
</g5-tr>

<!--결의서와 결의서내역-->

<g5-tr id="tr_all_r" >
    <param name="KeyName"  value="toinb_dataid4">
    <param name="KeyValue" value="JSP(O:DataSetBaKyeoluiseo=DataSetBaKyeoluiseo, O:DataSetBaKyeoluiseoDetl=DataSetBaKyeoluiseoDetl)">
    <param name="Action"   value="/servlet/GateServlet">
</g5-tr>

<g5-tr id="tr_all_u" >
    <param name="KeyName"  value="toinb_dataid4">
    <param name="KeyValue" value="JSP(I:DataSetBaKyeoluiseo=DataSetBaKyeoluiseo, I:DataSetBaKyeoluiseoDetl=DataSetBaKyeoluiseoDetl)">
    <param name="Action"   value="/servlet/GateServlet">
</g5-tr>

<g5-inputfile id=file_control style="display:none;"></g5-inputfile>

<!-- 그리드 상에서 팝업 처리 -->

<!--증빙종류 선택-->

<!--금액,부가세-->

<!-- 거래처 조회 -->

<!-- 그리드 마지막 Row에서 화살표 아래방향버튼 다운시 발생 -->

<!-- 첨부파일 선택, 제거 -->

<g5-dataset id=DataSetBaKyeoluiseo></g5-dataset>
<g5-dataset id=DataSetBaKyeoluiseoDetl></g5-dataset>
<g5-dataset id=DataSetBaJeungbing></g5-dataset>
<g5-dataset id=DataSetBaShortStr></g5-dataset>
<g5-dataset id=DataSetBaNum></g5-dataset>

<script>
/*************** 가우스 이벤트 처리 ***************/
g5Ready(function(){

    loadDataSetCreateCo('DataSetBaClntCode', 'tr_clnt_code');
    loadDataSetCreateCo('DataSetBaMgtItemCode', 'tr_mgt_item_code');
    loadDataSetCreateCo('DataSetBaProjCode', 'tr_proj_code');
	loadDataSetCreateCo('DataSetBaSawonCode', 'tr_sawon_code');
    loadDataSetCreateCo('DataSetBaBuseoCode', 'tr_buseo_code');
    loadDataSetCreateCo('DataSetBa3Fields', 'tr_one_naeyeok');		//내역정보 가져오기

    loadInTrCo("tr_main_u","DataSetBaKyeoluiseo");
    loadInTrCo("tr_detl_u","DataSetBaKyeoluiseoDetl");

    loadOutTrCo("tr_kyeoluiseo_r","DataSetBaKyeoluiseo");	//결의서 메인 조회
    loadOutTrCo("tr_jeungbing","DataSetBaJeungbing");
    loadOutTrCo("tr_kyeoluiseo_no_r","DataSetBaShortStr");
    loadOutTrCo("tr_jijeom_cnt_r", "DataSetBaNum");			//지점 갯수

DataSetBaKyeoluiseo.OnLoadCompleted = function(CountRow){
	if(CountRow>0) getKyeoluiseoDetl();
}
tr_detl_r.OnSuccess = function(){
	if((detlDsCls!="jongjeon")&&(DataSetBaKyeoluiseoDetl.CountRow>0)){
		txt_u_mgt_item_cd.value = DataSetBaKyeoluiseoDetl.NameValue(1,"u_mgt_item_cd").val;
		txt_mgt_item_nm.value = DataSetBaKyeoluiseoDetl.NameValue(1,"mgt_item_nm").val;
		txt_u_proj_cd.value = DataSetBaKyeoluiseoDetl.NameValue(1,"u_proj_cd").val;
		txt_proj_nm.value = DataSetBaKyeoluiseoDetl.NameValue(1,"proj_nm").val;
		txt_u_sawon_buseo_cd.value = DataSetBaKyeoluiseoDetl.NameValue(1,"u_sawon_buseo_cd").val;
		radio_sawon_buseo_cls.CodeValue = DataSetBaKyeoluiseoDetl.NameValue(1,"sawon_buseo_cls").val;
		txt_sawon_buseo_nm.value = DataSetBaKyeoluiseoDetl.NameValue(1,"sawon_buseo_nm").val;
	}	
}
tr_detl_r.OnFail = function(){
	alert(this.SrvErrMsg('ServerErrMsg', 0));
}
tr_all_u.OnSuccess = function(){
	alert(" 성공적으로 처리되었습니다! ");
	if(chk_yeonsok.checked) insert();
	else search();
}
tr_all_u.OnFail = function(){
	var indx = this.SrvErrMsg('ServerErrMsg', 0).indexOf("무결성");
	if(indx>=0){
		alert(" 동일한 결의서번호로 이미 작성되어 있습니다!! nn 결의서번호 끝자리를 증가시켜 작성해보시기 바랍니다. ");
		txt_kyeoluiseo_no.focus();
	}else if(this.ErrorMsg.indexOf("50014")>=0){
		alert(" 열려있는 첨부파일이 있는지 확인하시고 nn 열려있으면 닫은 후 저장하시기 바랍니다. ");  
	}else alert(this.SrvErrMsg('ServerErrMsg', 0));
}
grd_detl.OnPopup = function(Row,Colid,data){
	//승인구분이 미처리가 아닌 경우 수정불가
	if(DataSetBaKyeoluiseoDetl.NameValue(Row,"seungin_cls").val!="1"){
		errorMsgToTitleBarCo("승인구분이 미결인 경우만 수정할 수 있습니다!");
		DataSetBaKyeoluiseoDetl.Undo(DataSetBaKyeoluiseoDetl.RowPosition);
		return;
	}	
    if     (Colid=="U_CLNT_CD")    winPopup(9);
    else if(Colid=="U_NAEYEOK_CD") winPopup(10);
}
grd_detl.OnCloseUp = function(row,colid){
	//승인구분이 미처리가 아닌 경우 수정불가
	if(DataSetBaKyeoluiseoDetl.NameValue(row,"seungin_cls").val!="1"){
		errorMsgToTitleBarCo("승인구분이 미결인 경우만 수정할 수 있습니다!");
		DataSetBaKyeoluiseoDetl.Undo(DataSetBaKyeoluiseoDetl.RowPosition);
		return;
	}	
	if(colid=="U_JEUNGBING_CD"){
		var uClntCd = DataSetBaKyeoluiseoDetl.NameValue(row,"u_clnt_cd").val;
		var uJbCd = DataSetBaKyeoluiseoDetl.NameValue(row,"u_jeungbing_cd").val;
		var bugase = DataSetBaKyeoluiseoDetl.NameValue(row,"bugase").val;
		var jijeomCnt = getJijeomCnt();
		//증빙종류 101~105 (부가세 관련 있는 것)
		if(uJbCd=="101"||uJbCd=="102"||uJbCd=="103"||uJbCd=="104"||uJbCd=="105"){
			if(bugase==0) DataSetBaKyeoluiseoDetl.NameValue(row,"bugase").val = jeolsaCo(DataSetBaKyeoluiseoDetl.NameValue(row,"amt").val*0.1);
				grd_detl.ColumnProp("amt","Edit").val="RealNumeric";
				grd_detl.ColumnProp("bugase","Edit").val="RealNumeric";

			if(uJbCd=="101"||uJbCd=="102"){
				if(isNullCo(uClntCd)||jijeomCnt>0) winPopup(11);
				else removeChugaInfo();
			}else if(uJbCd=="103"||uJbCd=="104"||uJbCd=="105") winPopup(11);
		//수입세금계산서	
		}else if(uJbCd=="151"){
			DataSetBaKyeoluiseoDetl.NameValue(row,"amt").val = 0;
			grd_detl.ColumnProp("amt","Edit").val="None";
			grd_detl.ColumnProp("bugase","Edit").val="RealNumeric";
		}else{
			DataSetBaKyeoluiseoDetl.NameValue(row,"bugase").val = 0;
			grd_detl.ColumnProp("amt","Edit").val="RealNumeric";
			grd_detl.ColumnProp("bugase","Edit").val="None";
			if(uJbCd=="201"){ //계산서
				if(isNullCo(uClntCd)||jijeomCnt>0) winPopup(11);
				else removeChugaInfo();
			}else removeChugaInfo(); 
		}
		setSumText();
	}
}
grd_detl.OnExit = function(row,colid,olddata){
	//승인구분이 미처리가 아닌 경우 수정불가
	if(DataSetBaKyeoluiseoDetl.NameValue(row,"seungin_cls").val!="1"){
		errorMsgToTitleBarCo("승인구분이 미결인 경우만 수정할 수 있습니다!");
		DataSetBaKyeoluiseoDetl.Undo(DataSetBaKyeoluiseoDetl.RowPosition);
		return;
	}	
	var bugase = DataSetBaKyeoluiseoDetl.NameValue(row,"bugase").val;
	var uJbCd = DataSetBaKyeoluiseoDetl.NameValue(row,"u_jeungbing_cd").val;
	if(colid=="AMT"){
         if(bugase==0){
			 if(uJbCd=="101"||uJbCd=="102"||uJbCd=="103"||uJbCd=="104"||uJbCd=="105"){
			 	DataSetBaKyeoluiseoDetl.NameValue(row,"bugase").val = jeolsaCo(DataSetBaKyeoluiseoDetl.NameValue(row,"amt").val*0.1);
			 }	
		}	 
		grd_detl.SetColumn("bugase");
	}else if(colid=="NAEYEOK") grd_detl.SetColumn("bigo");
	if(colid=="AMT"||colid=="BUGASE") setSumText();
}
grd_detl.CanColumnPosChange = function(row,colid){
    if(colid=="U_CLNT_CD"){
        var chkColumnValue = DataSetBaKyeoluiseoDetl.NameValue(row,"u_clnt_cd").val;
        return checkDataSetGridCode(DataSetBaKyeoluiseoDetl,row,"clnt_nm","DataSetBaClntCode","u_clnt_cd","clnt_nm",chkColumnValue,"winPopup(9)","",tr_clnt_code,"b10ClntNm");
    }else if(colid=="U_NAEYEOK_CD"){
        var uSawonCd = txt_u_jakseongja_cd.value;
        var cls = "201"; 							//결의서 구분 : 청구(일반)(201)
        var uNaeyeokCd = DataSetBaKyeoluiseoDetl.NameValue(row,"u_naeyeok_cd").val;
    	return gCheckAndGetNaeyeokCo(DataSetBaKyeoluiseoDetl,uSawonCd,cls,uNaeyeokCd,"winPopup(10)");
    }else return true;
}
grd_detl.OnLastDown = function(){
    insertDetl();
}
grd_detl.OnLButtonDown = function(row,colid,xpos,ypos){
	if(colid=="URL_STR"){
	    grd_detl.MenuData="파일선택^1^2^1,파일삭제^1^4^1";
	    grd_detl.TrackPopupMenu(xpos, ypos);
	}		
}
grd_detl.OnCommand = function(code,str){
	var fileControl = document.getElementById('file_control');
	//파일선택(추가,변경)
    if(code==2){
		fileControl.value = '';
		fileControl.Open();
	//삭제
    }else if(code==4){
		DataSetBaKyeoluiseoDetl.NameValue(DataSetBaKyeoluiseoDetl.RowPosition,"url_str").val = '';
		fileControl.value = '';
	}
}
em_baluiil.OnLastChar = function(char){
	makeUpmuNo();
}
file_control.OnChange = function (fileName, file) {
	var nPos = DataSetBaKyeoluiseoDetl.RowPosition;
	DataSetBaKyeoluiseoDetl.NameValue(nPos,"url_str").val = document.getElementById('file_control').value;

	const fReader = new FileReader();
	fReader.readAsDataURL(file);

	fReader.onloadend = function(event){
		var sFile = event.target.result;
		DataSetBaKyeoluiseoDetl.NameValue(nPos,"file_value").val = sFile.substring(sFile.indexOf(",")+1,sFile.length);
	}
	document.getElementById('file_control').value = '';
}

init();
});
</script>

<body>
<table>
	<tr>
		<td>
			<iframe width="100%" height=24px style="display:block;" frameborder=0 scrolling=no src="/html/menubar_5.html" id="menubar" name="menubar"></iframe>
		</td>
	</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" >
	<tr> 
		<td>
			<iframe width="100%" height=40px marginwidth=0px marginheight=0px hspace=0 vspace=0 frameborder=0 scrolling=no src="/js/top_button_5.html" name="subbutton">
			</iframe>
		</td>
	</tr>
	<tr> 
	    <td class="td_bg" height="25px" valign="top">
	        <table width="100%" border="0" cellspacing="0" cellpadding="0">
		        <tr bgcolor="#1863BD" height="2px">
		            <td colspan="5"></td>
		        </tr>
		        <tr height="24px"> 
		            <td width="20px">&nbsp;</td>
		            <td width="20px"><img src="/images/icon/bu100.gif" width="11px" height="11px"></td>
		            <td width="280px"><span class="title">결의서등록 - 청구(일반)</span></td>
					<td  width="300px" align="left">
			            <span class="errorStyle" id="errorMessage"></span>&nbsp;&nbsp;
			        </td>
		            <td align="right"><span id="common_title"></span></td>
		        </tr>       
	        </table>
	    </td>
	</tr>
	<tr><td height="3px"></td></tr>
</table>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<col width="70px"><col width="150px"><col width="70px"><col width="155px"><col width="70px"><col width="190px"><col width=*>
    <tr class="title_bg">
		<td class="sub_title"><span>발의일</span></td>
		<td>

			<g5-emedit id="em_baluiil" width="90px" height="19px" class="object" onblur="checkDateLength(this);" tabIndex="1">
				<param name="Alignment"     value="1">
				<param name="SelectAll"     value="true">
				<param name="Format"        value="YYYY-MM-DD">
				<param name="ClipMode"      value="true">
		    </g5-emedit>

            <div class="div_button" onclick="calendarBaluiil();">조회</div>
		</td>
		<td class="sub_title"><span>청구일</span></td>
		<td>

			<g5-emedit id="em_cheongguil" width="90px" height="19px" class="object" onblur="checkDateLength(this);" tabIndex="2">
				<param name="Alignment"     value="1">
				<param name="SelectAll"     value="true">
				<param name="Format"        value="YYYY-MM-DD">
				<param name="ClipMode"      value="true">
		    </g5-emedit>

            <div class="div_button" onclick="calendarCheongguil();">조회</div>
		</td>
		<td class="sub_title">결의서번호</td>
		<td>
        	<Input type="text" class="txt_sr" id="txt_kyeoluiseo_no" size=22  maxlength=30 tabIndex="3">
            <div class="div_button" onclick="winPopup(1);">조회</div>
        </td>
		<td>
        	<Input type="text" class="txt_sr" id="txt_kyeoluiseo_title" size=35  maxlength=50  style="ime-mode:active" tabIndex="4">
        </td>
	</tr>
	<tr><td height="2px"></td></tr>
</table>    
<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<col width=70px><col width=380px><col width=*>
    <tr class="title_bg">
		<td class="sub_title">작성자</td>
		<td>
        	<Input type="text" class="txt_sr" id="txt_u_jakseongja_cd" size=12 maxlength=30  style="ime-mode:disabled" onBlur="chkPatten(this,'','lrtrim','upper','etc');userCodeCheckCo('DataSetBaKyeoluiseo','tr_clnt_code','jakseongja_nm','DataSetBaClntCode','b10ClntNm',this,'',noCode);" onKeyDown="nextFocusCo(nextFieldNm(this,2));" tabIndex="5">
	        <div class="div_button" onclick="winPopup(2);">조회</div>
        	<Input type="text" class="txt_sr" id="txt_jakseongja_nm" size=30  maxlength=30>
		</td>
        <td><input id="chk_yeonsok" type="checkbox" >저장후 연속입력</td>
    </tr>
	<tr><td height="2px"></td></tr>
</table>
<table width="100%" border="1" borderColor="#0000ff" cellspacing="0" cellpadding="0">
	<tr>
	<td align="center"><b>&nbsp;결 재&nbsp;</b></td>
	<td align="left" valign="top">
		<table width="100%" border="0" cellspacing="0" cellpadding="0">
		    <tr class="title_bg">
				<td class="sub_title" width=55px>결재상태</td>
				<td width=90px>

					<g5-luxecombo id="luxe_kyeoljae_cls" style="width:80px;height:20px" class="object" tabIndex="7">
						<param name="CBData"	     value="0^미결재,1^검토,A^검토2,2^승인">
						<param name="CBDataColumns"	 value="code,name">
				        <param name="ComboStyle"     value="3">
						<param name="Enable"         value="false">
				        <param name="SearchColumn"   value="code">
				        <param name="EditExprFormat" value="%;name">
				        <param name="ListExprFormat" value="code^1^20,name^1^80">
						<param name="ListCount"      value="25"> 
				        <param name="BindColumn"     value="code">
					</g5-luxecombo>

		        </td>	
		        <td class="sub_title" width=55px>검토자</td>
		        <td width=205px>
		            <input type="text" class="txt_sr" id="txt_u_geomtoja_cd" size="8" style="ime-mode:disabled" onBlur="chkPatten(this,'','lrtrim','upper','etc');userCodeCheckCo('DataSetBaKyeoluiseo','tr_clnt_code','geomtoja_nm','DataSetBaClntCode','b10ClntNm',this,'',noCode);" onKeyDown="nextFocusCo(nextFieldNm(this,2));" tabIndex="8">
		            <div class="div_button" id="btn_geomtoja" onclick="winPopup(4)">조회</div>   
		            <input type="text" class="txt_sr" id="txt_geomtoja_nm" size=11 maxlength=50>
		        </td>
		        <td class="sub_title" id="td_geomtoja2_1" width=55px><span id="span_geomtoja2">검토자2</span></td>
		        <td id="td_geomtoja2_2" width=205px>
		            <input type="text" class="txt_sr" id="txt_u_geomtoja2_cd" size="8" style="ime-mode:disabled" onBlur="chkPatten(this,'','lrtrim','upper','etc');userCodeCheckCo('DataSetBaKyeoluiseo','tr_clnt_code','geomtoja2_nm','DataSetBaClntCode','b10ClntNm',this,'',noCode);" onKeyDown="nextFocusCo(nextFieldNm(this,2));" tabIndex="8">
		            <div class="div_button" id="btn_geomtoja2" onclick="winPopup(12)">조회</div>   
		            <input type="text" class="txt_sr" id="txt_geomtoja2_nm" size=11 maxlength=50>
		        </td>
		        <td class="sub_title" width=55px>승인자</td>
		        <td width=*>
		            <input type="text" class="txt_sr" id="txt_u_seunginja_cd" size="8" style="ime-mode:disabled" onBlur="chkPatten(this,'','lrtrim','upper','etc');userCodeCheckCo('DataSetBaKyeoluiseo','tr_clnt_code','seunginja_nm','DataSetBaClntCode','b10ClntNm',this,'',noCode);" onKeyDown="if(event.keyCode==13)grd_detl.Focus();" tabIndex="9">
		            <div class="div_button" id="btn_seunginja" onclick="winPopup(5)">조회</div>   
		            <input type="text"class="txt_sr" id="txt_seunginja_nm" size=11 maxlength=50>
		        </td>
			</tr>
			<tr><td height="2px"></td></tr>
		</table>
	</td>
	</tr>
</table>

<fieldset style="padding-left: 5pt; font-size: 9pt; padding-bottom: 0pt; width:100%; padding-top: 0pt">
    <table width="100%" border="0" cellpadding="0" cellspacing="0">
		<col width=30px><col width=70px><col width=670px><col width=*>
	    <tr>
	    	<td>&nbsp;</td>
	    	<td><button id="btn_row_insert" class="btn_dml" onClick="insertDetl();">행추가</button></td>
	    	<td><button id="btn_row_delete" class="btn_dml" onClick="removeDetl();">행삭제</button></td>
	    	<td><button id="btn_jongjeon_kyeol_popup" class="btn_dml" onClick="winPopup(13);">종전결의서조회</button></td>
	    </tr>
	</table>    
    <table width="100%" bordercolorlight="#8F8F8F"  bordercolordark="#FFFFFF" border="1" cellpadding="0" cellspacing="0"  class="content_color" >
    	<tr>
    		<td>

	            <g5-grid id="grd_detl" width="100%" height="340px" tabIndex="10">
		            <param name="DataID"        value="DataSetBaKyeoluiseoDetl">
		            <param name="ColSizing"     value="true">
		            <param name="IndWidth"      value="20">
		            <param name="TitleHeight"   value="20">
		            <param name="Editable"      value="true">
		            <param name="ViewSummary"   value="1">
		            <param name="Format"        value="
						<C>Name=승인	    ID=seungin_cls		edit=none EditStyle=Combo Data='1:미결,2:보류,3:부결,4:기결' HeadBgColor=#ececff Width=50  Align=Center</C>
						<C>Name=거래처코드	ID=u_clnt_cd		editStyle=popup HeadBgColor=#ececff Width=80  Align=left</C>
						<C>Name=거래처명	ID=clnt_nm			HeadBgColor=#ececff Width=120  Align=left</C>
						<C>Name=증빙종류	ID=u_jeungbing_cd	EditStyle=Lookup Data='DataSetBaJeungbing:u_jeungbing_cd:jeungbing_nm' HeadBgColor=#ececff Width=120  Align=left SumBgColor=#FFFF99 sumtext=' 합 계 '</C>
						<C>Name=금액		ID=amt				dec=0 HeadBgColor=#ececff Width=90  Align=right SumBgColor=#FFFF99 sumtext=@sum</C>
						<C>Name=부가세		ID=bugase			edit=none dec=0 HeadBgColor=#ececff Width=90  Align=right SumBgColor=#FFFF99 sumtext=@sum</C>
						<C>Name=청구합계	ID=amt_sum		    edit=none dec=0 HeadBgColor=#ececff Width=90  Align=right SumBgColor=#FFFF99  sumtextalign=right sumtext=@sum</C>
						<C>Name=코드		ID=u_naeyeok_cd		editStyle=popup HeadBgColor=#ececff Width=50  Align=Center</C>
						<C>Name=내역		ID=naeyeok			HeadBgColor=#ececff Width=140  Align=left</C>
						<C>Name=비고		ID=bigo				HeadBgColor=#ececff Width=110  Align=left</C>
						<C>Name=비고2		ID=bigo2			show=false HeadBgColor=#ececff Width=110  Align=left</C>
						<C>Name=첨부파일	ID=url_str          edit=none show=false HeadBgColor=#ececff Width=150  Align=left</C>
		            ">
	            </g5-grid>

            </td>
        </tr>
    </table>
</fieldset>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<col width="70px"><col width="130px"><col width="270px"><col width="70px"><col width="130px"><col width=*>
	<tr class="title_bg">
	     <td class="sub_title">관리항목</td>
	     <td>
	       <input type="text" class="txt_sr" id="txt_u_mgt_item_cd" style="ime-mode:disabled" size="12" tabIndex="11">
	        <div class="div_button" onclick="winPopup(6);">조회</div>
	 	</td>
	    <td>
	        <input type="text" class="txt_sr" id="txt_mgt_item_nm" size="30" >
	    </td>
		<td class="sub_title">프로젝트</td>
		<td>
			<input type="text" class="txt_sr"  id="txt_u_proj_cd" style="ime-mode:disabled" size="12" tabIndex="12">
			<div class="div_button" onclick="winPopup(7);">조회</div>
		</td>
		<td>
			<input type="text" class="txt_sr" id="txt_proj_nm" size="30" >
		</td>
	</tr>
	<tr><td height="2px"></td></tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<col width="70px"><col width="130px"><col width="100px"><col width=*>
	<tr class="title_bg"><td class="sub_title">사원부서</td>
		<td>
			<input type="text" class="txt_sr" id="txt_u_sawon_buseo_cd" style="ime-mode:disabled" size="12" onFocus="setDefaultSawonOrBuseo();" tabIndex="13">
				<button id="btn_sawon_buseo" class="search" onclick="winPopup(8);">
			<img src="/images/btn_search.gif" alt="검색"></button>
		</td>
		<td>
			<input type="text" class="txt_sr" id="txt_sawon_buseo_nm" size="30" >
		</td>
		<td>

				<g5-radio id="radio_sawon_buseo_cls" style="height:24px; width:120px">
					<param name=Cols    value="2">
					<param name=Format  value="1^사원,2^부서">
				</g5-radio>

		</td>
	</tr>
	<tr><td height="2px"></td></tr>
</table>
</body>
<!----------------------------  Bind Component ---------------------------------->
<g5-bind id="bnd_master"> 
    <param name="DataID"    value="DataSetBaKyeoluiseo">
    <param name="BindInfo"  value="
		<C>Col=baluiil			Ctrl=em_baluiil				Param=Text</C>
		<C>Col=cheonggu_j_il	Ctrl=em_cheongguil			Param=Text</C>
		<C>Col=kyeoluiseo_no	Ctrl=txt_kyeoluiseo_no		Param=Value</C>
		<C>Col=kyeoluiseo_title	Ctrl=txt_kyeoluiseo_title   Param=Value</C>
		<C>Col=u_jakseongja_cd	Ctrl=txt_u_jakseongja_cd	Param=Value</C>
		<C>Col=jakseongja_nm	Ctrl=txt_jakseongja_nm		Param=Value</C>
		<C>Col=kyeoljae_cls		Ctrl=luxe_kyeoljae_cls		Param=BindColVal</C>
		<C>Col=u_geomtoja_cd	Ctrl=txt_u_geomtoja_cd		Param=Value</C>
		<C>Col=geomtoja_nm		Ctrl=txt_geomtoja_nm		Param=Value</C>
		<C>Col=u_geomtoja2_cd	Ctrl=txt_u_geomtoja2_cd		Param=Value</C>
		<C>Col=geomtoja2_nm		Ctrl=txt_geomtoja2_nm		Param=Value</C>
		<C>Col=u_seunginja_cd	Ctrl=txt_u_seunginja_cd		Param=Value</C>
		<C>Col=seunginja_nm		Ctrl=txt_seunginja_nm		Param=Value</C>
    ">
</g5-bind>

</html>